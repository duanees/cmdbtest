{% extends 'base.html' %}
{% block title %}资产总览{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static',filename='css/inventory.css') }}">
{% endblock %}

{% block main %}
    <div class="container">
        <div><h1>资产管理</h1></div>
        <div class="panel-body">
            <div class="list-op" id="list_op">
                <button type="button" class="btn btn-default btn-sm">
                    <a href="{{ url_for('main.create') }}"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>添加</a>
                </button>
                <button type="button" class="btn btn-default btn-sm">
                    <a href="{{ url_for('main.update') }}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改</a>
                </button>
                <button type="button" class="btn btn-default btn-sm">
                    <a href="{{ url_for('main.delete') }}"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除</a>
                </button>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-hover table-condensed table-bordered">
                <thead>
                <tr class="info">
                    {% for opt in thead_list %}
                        <th>
                            <nobr>{{ opt }}</nobr>
                        </th>
                    {% endfor %}
                </tr>
                </thead>
                <tbody>
                {% for data in datas %}
                    <tr>
                        <td>
                            <nobr>{{ data.serial_no | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.type_name }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.idc_name | replace_none }} {{ data.cabinet | replace_none }} {{ data.cabinet_addresses | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.host_name | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.model | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.asset_code | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.asset_sn | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.ip_business_code | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.ip_value | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.ip_admin }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.department | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.interfac_person | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.project | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.project_contract | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.project_acceptance_time | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.state | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.off_shelf_evaluation | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.cpu_config | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.memory_config | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.disk_config | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.cpu_use_rate | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.memory_use_rate | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.disk_use_rate | replace_none }}</nobr>
                        </td>
                        <td>
                            <nobr>{{ data.remark | replace_none }}</nobr>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <div>
            <ul class="pagination">
                <li class=''><a href='/inventory?page=1'>首页</a></li>
                {% if page_dict.page > 1 %}
                    <li class=''><a href='/inventory?page={{ page_dict.page - 1 }}'>上一页</a></li>
                {% else %}
                    <li class=''><a href='/inventory?page=1'>上一页</a></li>
                {% endif %}

                {% for dic in page_dict.dic_list %}
                    {% if dic==page_dict.page %}
                        <li class="active"><a href="/inventory?page={{ dic }}">{{ dic }}</a></li>
                    {% else %}
                        <li><a href="/inventory?page={{ dic }}">{{ dic }}</a></li>
                    {% endif %}
                {% endfor %}
                {% if page_dict.page < page_dict.total %}
                    <li class=''><a href='/inventory?page={{ page_dict.page + 1 }}'>下一页</a></li>
                {% else %}
                    <li class=''><a href='/inventory?page={{ page_dict.total }}'>下一页</a></li>
                {% endif %}
                <li class=''><a href='/inventory?page={{ page_dict.total }}'>尾页</a></li>
                <li class=''>共{{ page_dict.total }}页</li>
            </ul>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    <script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        $(function () {
            function initTableCheckbox() {
                var $thr = $('table thead tr');
                var $checkAllTh = $('<th><input type="checkbox" id="checkAll" name="checkAll" /></th>');
                /*将全选/反选复选框添加到表头最前，即增加一列*/
                $thr.prepend($checkAllTh);
                /*“全选/反选”复选框*/
                var $checkAll = $thr.find('input');
                $checkAll.click(function (event) {
                    /*将所有行的选中状态设成全选框的选中状态*/
                    $tbr.find('input').prop('checked', $(this).prop('checked'));
                    /*并调整所有选中行的CSS样式*/
                    if ($(this).prop('checked')) {
                        $tbr.find('input').parent().parent().addClass('warning');
                    } else {
                        $tbr.find('input').parent().parent().removeClass('warning');
                    }
                    /*阻止向上冒泡，以防再次触发点击操作*/
                    event.stopPropagation();
                });
                /*点击全选框所在单元格时也触发全选框的点击操作*/
                $checkAllTh.click(function () {
                    $(this).find('input').click();
                });
                var $tbr = $('table tbody tr');
                var $checkItemTd = $('<td><input type="checkbox" name="checkItem" /></td>');
                /*每一行都在最前面插入一个选中复选框的单元格*/
                $tbr.prepend($checkItemTd);
                /*点击每一行的选中复选框时*/
                $tbr.find('input').click(function (event) {
                    /*调整选中行的CSS样式*/
                    $(this).parent().parent().toggleClass('warning');
                    /*如果已经被选中行的行数等于表格的数据行数，将全选框设为选中状态，否则设为未选中状态*/
                    $checkAll.prop('checked', $tbr.find('input:checked').length == $tbr.length ? true : false);
                    /*阻止向上冒泡，以防再次触发点击操作*/
                    event.stopPropagation();
                });
                /*点击每一行时也触发该行的选中操作*/
                $tbr.click(function () {
                    $(this).find('input').click();
                });
            }

            initTableCheckbox();
        });
    </script>
{% endblock %}